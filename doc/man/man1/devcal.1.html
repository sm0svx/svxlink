<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sun May  4 14:24:08 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>DEVCAL</title>

</head>
<body>

<h1 align="center">DEVCAL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#CALIBRATING AN RTL2832U BASED DVB-T USB DONGLE">CALIBRATING AN RTL2832U BASED DVB-T USB DONGLE</a><br>
<a href="#CALIBRATING THE TRANSMITTER">CALIBRATING THE TRANSMITTER</a><br>
<a href="#CALIBRATING THE RECEIVER">CALIBRATING THE RECEIVER</a><br>
<a href="#EXAMPLE: CALIBRATING USING A DVB-T USB DONGLE">EXAMPLE: CALIBRATING USING A DVB-T USB DONGLE</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#REPORTING BUGS">REPORTING BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">devcal &minus;
An FM deviation calibration utility for the SvxLink
system</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>devcal
[-?|--help] [-h|--usage] [-f|--modfqs=</b><i>frequencies in
Hz</i><b>] [-d|--caldev=</b><i>deviation in Hz</i><b>]
[-m|--maxdev=</b><i>deviation in Hz</i><b>]
[-H|--headroom=</b><i>Headroom in dB</i><b>] [-r|--rxcal]
[-F|--flat] [-M|--measure] [-w|--wide]
[-a|--audiodev=</b><i>type:dev</i><b>] &lt;</b><i>config
file</i><b>&gt; &lt;</b><i>config section</i><b>&gt;</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>devcal</b> is
a utility that is used to calibrate the input and output
sound levels (deviation) on an FM SvxLink system. The idea
is that it should be possible to calibrate multiple parts of
a SvxLink system to the exact same sound levels. This will
ensure that a system using multiple receivers have the same
sound level for all receivers and for a repeater it means
that the audio being retransmitted is at the same level as
the received audio. For an EchoLink system it will guarantee
that audio received by the local node will be at a proper
level to be retransmitted on remote EchoLink nodes, and the
other way around.</p>

<p style="margin-left:9%; margin-top: 1em">An RTL2832U
based DVB-T USB dongle can be used to measure deviation and
the devcal utility can also be used to calibrate the
receiving frequency correction for such a dongle.</p>

<p style="margin-left:9%; margin-top: 1em">Deviation
calibration can be done both with and without a DVB-T USB
dongle. Both methods are described below.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>-?|--help</b></p>

<p style="margin-left:18%;">Print a help message and
exit.</p>

<p style="margin-left:9%;"><b>-h|--usage</b></p>

<p style="margin-left:18%;">Display a brief help message
and exit.</p>


<p style="margin-left:9%;"><b>-f|--modfqs</b><i>frequencies
in Hz</i></p>

<p style="margin-left:18%;">Use this command line option to
set at what frequencies you want to calibrate the deviation.
Separate multiple frequencies using commas. The default
frequency is 1000Hz.</p>

<p style="margin-left:9%;"><b>-d|--caldev=</b><i>deviation
in Hz</i></p>

<p style="margin-left:18%;">The deviation value at where to
perform the calibration. The default value of 2404,8Hz may
seem strange but it will be explained below.</p>

<p style="margin-left:9%;"><b>-m|--maxdev=</b><i>deviation
in Hz</i></p>

<p style="margin-left:18%;">The maximum deviation used on
the channel. This is the deviation value where transmitters
start to limit the deviation so as not to cause interference
in neighbouring channels. The default value is 5000Hz.</p>


<p style="margin-left:9%;"><b>-H|--headroom=</b><i>headroom
in dB</i></p>

<p style="margin-left:18%;">The headroom is the margin to
add above the maximum deviation level. Adding a headroom
will allow SvxLink to handle levels above the maximum
deviation level without causing immediate distortion. The
default is 6dB which mean that SvxLink can handle twice the
specified maximum deviation. If both maxdev and headroom are
left at their default this will mean that SvxLink can handle
10kHz deviation without distortion.</p>

<p style="margin-left:18%; margin-top: 1em">Changing the
headroom cause a lot of different effects so don&rsquo;t do
that unless you are prepared to deal with the problems. For
example, increasing the headroom will cause the TX level to
get lower and the RX level to get higher, which then must be
compensated. The announcement levels will get lower so they
also need to be compensated. The EchoLink RX/TX levels will
get unbalanced and at the moment there is no way to fix
that.</p>

<p style="margin-left:9%;"><b>-r|--rxcal</b></p>

<p style="margin-left:18%;">Specify this command line
option to perform receiver calibration.</p>

<p style="margin-left:9%;"><b>-t|--txcal</b></p>

<p style="margin-left:18%;">Specify this command line
option to perform transmitter calibration.</p>

<p style="margin-left:9%;"><b>-F|--flat</b></p>

<p style="margin-left:18%;">Perform calibration on a
transmitter or receiver that has a flat frequency response
(no pre- or de-emphasis). If the transceiver has flat
frequency response but you have enabled pre-/de-emphasis in
SvxLink, this option should NOT be specified.</p>

<p style="margin-left:9%;"><b>-M|--measure</b></p>

<p style="margin-left:18%;">The measurement mode requires
the use of a RTL2832U based DVB-T USB dongle and will
measure the received deviation.</p>

<p style="margin-left:9%;"><b>-w|--wide</b></p>

<p style="margin-left:18%;">Use wide FM (broadcast) instead
of narrow band FM</p>


<p style="margin-left:9%;"><b>-a|--audiodev=</b><i>type:dev</i></p>

<p style="margin-left:18%;">Use this command line option to
set an audio device to use for playing back the received
audio. The default is to use &quot;alsa:default&quot;.
Disable audio output by setting the audio device to the
empty string (i.e. --audiodev=&quot;&quot;).</p>

<h2>CALIBRATING AN RTL2832U BASED DVB-T USB DONGLE
<a name="CALIBRATING AN RTL2832U BASED DVB-T USB DONGLE"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">All RTL2832U
based DVB-T USB dongles requires calibration so that the
specified receiving frequency is correct. Most dongles are
way off in frequency. 50-60ppm is not uncommon which
translates to more than 20kHz on 434MHz.</p>

<p style="margin-left:9%; margin-top: 1em">Most dongles are
sensitive to temperature change so start by plugging the
dongle into the computer and let it warm up for like 15
minutes before doing the calibration.</p>

<p style="margin-left:9%; margin-top: 1em">Devcal need a
receiver configuration file to work so such a file must be
created before this utility can be used. Read the Ddr
Receiver Section and the Wideband Receiver Section in the
<b>svxlink.conf</b>(5) manual page for information on how to
set it up.</p>

<p style="margin-left:9%; margin-top: 1em">A first coarse
calibration should be done in wideband mode so that the
calibration carrier is easy to find. You can use any FM
carrier to calibrate on that you know is correct in
frequency. It does not matter if the carrier is modulated or
not. Use your own transceiver or a repeater for example. If
the frequency calibration is unknown for the transmitter
being used it may be wise to test with multiple
transmitters. The command line may look like this:</p>

<p style="margin-left:9%; margin-top: 1em">devcal -Mw
/path/to/svxlink.conf RxRtl</p>

<p style="margin-left:9%; margin-top: 1em">The utility will
print, among other things, the carrier frequency error. It
may look something like:</p>

<p style="margin-left:9%; margin-top: 1em">Tone dev=7.30
Full bw dev=39198.90 Carrier freq err=-27713.53(-64ppm)</p>

<p style="margin-left:9%; margin-top: 1em">We ignore the
first two values for now and concentrate on the carrier
frequency error. The -64ppm mean that the dongle is
receiving the transmitted carrier about 27kHz below the set
frequency. To compensate for this, set the FQ_CORR
configuration variable in the wideband receiver
configuration section to 64. Do another measurement to
verify that the received carrier frequency is now closer to
the expected one.</p>

<p style="margin-left:9%; margin-top: 1em">Now we can do
the final calibration in narrow band mode. Remove the
&quot;w&quot; command line option from the command above and
do another measurement. Adjust FQ_CORR until a value around
0ppm is shown.</p>

<h2>CALIBRATING THE TRANSMITTER
<a name="CALIBRATING THE TRANSMITTER"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">In order to
calibrate the transmitted deviation we need a way to measure
it. There are multiple methods to do that. If you have a
deviation meter you&rsquo;re in luck but most people does
not own one of those. Fortuantely there are other ways.</p>

<p style="margin-left:9%; margin-top: 1em">One way is to
use a RTL2832U based DVB-T dongle with the devcal utility.
First calibrate the DVB-T dongle according to the
instructions in the previous section. The devcal utility can
then be used in measurement mode to measure the transmitted
FM deviation. The measurement mode is activated using the
&quot;-M&quot; command line option. Use the &quot;-f&quot;
command line option to specify the audio frequency to
calibrate at if the default of 1000Hz need to be
changed.</p>

<p style="margin-left:9%; margin-top: 1em">Another way to
measure FM deviation without a deviation meter is to use the
Bessel null method. It makes use of the fact that the FM
carrier will go down to zero power for certain combinations
of modulation frequency and deviation. The deviation divided
by the modulation frequency give something called the
modulation index. Bessel nulls occur at specific modulation
indexes where the first one is at 2.4048. So, if we choose
the deviation to 2404.8Hz and the modulation frequency to
1000Hz we should get a Bessel null when the transmitter is
calibrated. These are the default modulation parameters in
devcal.</p>

<p style="margin-left:9%; margin-top: 1em">So how can we
detect when the carrier power goes down to zero? If you own
some form of spectrum analyzer the spectrum can be watched
to see when the carrier falls down to zero. If you own a CW
receiver that covers the frequency of interest you can use
that to listen to the carrier. Start devcal in transmitter
calibration mode using a command looking like the one
below.</p>

<p style="margin-left:9%; margin-top: 1em">devcal -t
/path/to/svxlink.conf Tx1</p>

<p style="margin-left:9%; margin-top: 1em">In another
window, start the alsamixer utility or some other utility to
adjust the audio output level. Set the output level to zero.
Go back to the devcal window and press 0 to set MASTER_GAIN
to zero. Press T to start transmitting. Since we set the
sound output level to zero only a carrier will be
transmitted. Adjust the CW receiver to center on the
carrier. Use the narrowest filter that the receiver support.
Now start increasing the audio output level in alsamixer.
Listen to the tone to find the first minimum. Use the +/-
keys in deval to fine tune the output level to a minimum.
You have now found the calibration values for the
transmitter. The printed value of MASTER_GAIN should be
entered into the configuration section for the
transmitter.</p>

<h2>CALIBRATING THE RECEIVER
<a name="CALIBRATING THE RECEIVER"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">To calibrate the
receiver we need a transmitter with a known calibration. If
possible, the transmitter that was calibrated above can be
used. If it&rsquo;s not possible, another transmitter can be
calibrated in the same way to be used as a calibration
transmitter. Start the devcal utility something like
this:</p>

<p style="margin-left:9%; margin-top: 1em">devcal -r
/path/to/svxlink.conf Rx1</p>

<p style="margin-left:9%; margin-top: 1em">Start alsamixer
in another window and adjust the input level to get as close
as possible to the expected deviation. Use the 0, + and -
keys to adjust PREAMP to fine tune the deviation that is
shown. When satisfied, enter the PREAMP value into the
configuration file in the receiver section.</p>

<h2>EXAMPLE: CALIBRATING USING A DVB-T USB DONGLE
<a name="EXAMPLE: CALIBRATING USING A DVB-T USB DONGLE"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This is an
example of how the calibration procedure may be performed
using a DVB-T USB dongle and an arbitrary transmitter, like
a handie transceiver.</p>

<p style="margin-left:9%; margin-top: 1em">The calibration
transmitter, a handie transmitter for example, must be able
to send some form of modulated tone for this procedure to
work. The 1750Hz tone burst that many transmitters are
equipped with is a good one to use. It is also possible to
use a DTMF tone but the results is not as good as when using
a single tone, it seems. If using DTMF, try using the code
&quot;A&quot; (1633Hz) or &quot;3&quot; (1477Hz). In this
example, the use of 1750Hz tone burst is described.</p>

<p style="margin-left:9%; margin-top: 1em">Use the DVB-T
dongle to measure the deviation of the 1750Hz tone.</p>

<p style="margin-left:9%; margin-top: 1em">devcal -M -f1750
/path/to/svxlink.conf RxRtl</p>

<p style="margin-left:9%; margin-top: 1em">Start
transmitting with the calibration transmitter and wait for
the values to stablilize. Take a note of the value for
&quot;tone dev&quot;. It may be something like 3200Hz, which
is used in the example below. Leave deval running since we
will need it later on.</p>

<p style="margin-left:9%; margin-top: 1em">On the system
being calibrated, start the receiver calibration.</p>

<p style="margin-left:9%; margin-top: 1em">devcal -r -f1750
/path/to/svxlink.conf Rx1</p>

<p style="margin-left:9%; margin-top: 1em">Transmit using
the calibration transmitter and adjust the input level using
alsamixer and PREAMP to the correct level for &quot;tone
dev&quot;.</p>

<p style="margin-left:9%; margin-top: 1em">Make sure that
devcal is started in measurement mode like when the
deviation on the calibration transmitter was measured above.
Then, on the system being calibrated, start the transmitter
calibration.</p>

<p style="margin-left:9%; margin-top: 1em">devcal -t -f1750
-d3200 /path/to/svxlink.conf Tx1</p>

<p style="margin-left:9%; margin-top: 1em">The value of
3200 was the one we measured in the first step. Adjust it to
match your own measurements. Adjust the output level using
alsamixer and MASTER_GAIN to get the correct reading for
&quot;tone dev&quot;.</p>

<p style="margin-left:9%; margin-top: 1em">To check the
calibration, use devcal in measurement mode to measure the
deviation on the transmitter when retransmitting a received
signal. For a repeater that is easily achieved by
transmitting on the receive frequency using the calibration
transmitter. The deviation measurement should show the
correct value being retransmitted. For a simplex link the
parrot can be used to achieve the same thing.</p>

<p style="margin-left:9%; margin-top: 1em">NOTE: The
retransmitted deviation may not be exactly the same for some
transceivers. This is an issue that remains to find the
cause of.</p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em">ASYNC_AUDIO_NOTRIGGER</p>

<p style="margin-left:18%;">Set this environment variable
to 1 if you get an error about <b>ioctl: Broken pipe</b>
during devcal startup when using OSS audio.</p>

<p style="margin-left:9%;">ASYNC_AUDIO_ALSA_ZEROFILL</p>

<p style="margin-left:18%;">Set this environment variable
to 0 to stop the Alsa audio code from writing zeros to the
audio device when there is no audio to write available.
ASYNC_AUDIO_UDP_ZEROFILL Set this environment variable to 1
to enable the UDP audio code to write zeros to the UDP
connection when there is no audio to write available.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Tobias Blomberg
(SM0SVX) &lt;sm0svx at svxlink dot org&gt;</p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Bugs should be
reported using the issue tracker at
https://github.com/sm0svx/svxlink.</p>

<p style="margin-left:9%; margin-top: 1em">Questions about
SvxLink should not be asked using the issue tracker. Instead
use the group set up for this purpose at groups.io:
https://groups.io/g/svxlink</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>svxlink</b>(1),
<b>remotetrx.conf</b>(5), <b>svxlink.conf</b>(5),
<b>siglevdetcal</b>(1)</p>
<hr>
</body>
</html>
